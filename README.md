# PyTorchæ·±åº¦å­¦ä¹ å¿«é€Ÿå…¥é—¨æ•™ç¨‹

<div align="center">

**åŸºäºBç«™ã€å°åœŸå †ã€‘PyTorchæ·±åº¦å­¦ä¹ å¿«é€Ÿå…¥é—¨æ•™ç¨‹çš„å­¦ä¹ ç¬”è®°ä¸ä»£ç å®è·µ**

[![PyTorch](https://img.shields.io/badge/PyTorch-1.x-red.svg)](https://pytorch.org/)
[![Python](https://img.shields.io/badge/Python-3.x-blue.svg)](https://www.python.org/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

</div>

---

## ğŸ“– ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [æ•™ç¨‹æ¥æº](#æ•™ç¨‹æ¥æº)
- [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [æ¨¡å—è¯¦è§£](#æ¨¡å—è¯¦è§£)
  - [æ•°æ®å¤„ç†æ¨¡å—](#æ•°æ®å¤„ç†æ¨¡å—)
  - [ç¥ç»ç½‘ç»œå±‚æ¨¡å—](#ç¥ç»ç½‘ç»œå±‚æ¨¡å—)
  - [æ¨¡å‹è®­ç»ƒæ¨¡å—](#æ¨¡å‹è®­ç»ƒæ¨¡å—)
  - [æ¨¡å‹æµ‹è¯•ä¸åº”ç”¨](#æ¨¡å‹æµ‹è¯•ä¸åº”ç”¨)
- [Jupyterç¬”è®°](#jupyterç¬”è®°)
- [å­¦ä¹ è·¯å¾„](#å­¦ä¹ è·¯å¾„)
- [æ•°æ®é›†è¯´æ˜](#æ•°æ®é›†è¯´æ˜)
- [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [è®¸å¯è¯](#è®¸å¯è¯)

---

## ğŸ¯ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯å­¦ä¹ Bç«™ã€å°åœŸå †ã€‘PyTorchæ·±åº¦å­¦ä¹ å¿«é€Ÿå…¥é—¨æ•™ç¨‹çš„é…å¥—ä»£ç ä¸ç¬”è®°æ•´ç†ã€‚é¡¹ç›®åŒ…å«äº†ä»PyTorchåŸºç¡€åˆ°æ·±åº¦å­¦ä¹ æ¨¡å‹è®­ç»ƒçš„å®Œæ•´æµç¨‹ï¼Œé€‚åˆæ·±åº¦å­¦ä¹ åˆå­¦è€…ç³»ç»Ÿå­¦ä¹ PyTorchæ¡†æ¶ã€‚

**ä¸»è¦å†…å®¹åŒ…æ‹¬ï¼š**
- âœ… PyTorchæ•°æ®åŠ è½½ä¸é¢„å¤„ç†
- âœ… TensorBoardå¯è§†åŒ–å·¥å…·ä½¿ç”¨
- âœ… ç¥ç»ç½‘ç»œå„å±‚è¯¦è§£ï¼ˆå·ç§¯ã€æ± åŒ–ã€æ¿€æ´»ã€å…¨è¿æ¥ç­‰ï¼‰
- âœ… æ¨¡å‹æ­å»ºä¸Sequentialä½¿ç”¨
- âœ… æŸå¤±å‡½æ•°ä¸ä¼˜åŒ–å™¨
- âœ… å®Œæ•´çš„è®­ç»ƒä¸æµ‹è¯•æµç¨‹
- âœ… GPUåŠ é€Ÿè®­ç»ƒ
- âœ… æ¨¡å‹ä¿å­˜ä¸åŠ è½½
- âœ… é¢„è®­ç»ƒæ¨¡å‹ä½¿ç”¨

---

## ğŸ“ æ•™ç¨‹æ¥æº

æœ¬é¡¹ç›®åŸºäºä»¥ä¸‹ä¼˜ç§€æ•™ç¨‹ï¼š

**è§†é¢‘æ•™ç¨‹ï¼š** [ã€å°åœŸå †ã€‘PyTorchæ·±åº¦å­¦ä¹ å¿«é€Ÿå…¥é—¨æ•™ç¨‹](https://www.bilibili.com/video/BV1hE411t7RN)

**æºä»£ç å‚è€ƒï¼š** https://github.com/xiaotudui/pytorch-tutorial

**ç¬”è®°å‚è€ƒï¼š** https://github.com/AccumulateMore/CV

### å®˜æ–¹æ–‡æ¡£
- [PyTorchå®˜æ–¹æ–‡æ¡£](https://pytorch.org/docs/stable/index.html)
- [torchvisionå®˜æ–¹æ–‡æ¡£](https://pytorch.org/vision/stable/index.html)
- [TensorBoardå®˜æ–¹æ–‡æ¡£](https://www.tensorflow.org/tensorboard)

---

## ğŸ’» ç¯å¢ƒè¦æ±‚

### åŸºç¡€ç¯å¢ƒ
- Python 3.7+
- PyTorch 1.x
- torchvision
- CUDA (å¯é€‰ï¼Œç”¨äºGPUåŠ é€Ÿ)

### ä¾èµ–åŒ…
```bash
torch>=1.7.0
torchvision>=0.8.0
tensorboard>=2.4.0
numpy
pillow
matplotlib
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/MengQxuan/PytorchByTuDui.git
cd PytorchByTuDui
```

### 2. å®‰è£…ä¾èµ–
```bash
pip install torch torchvision tensorboard numpy pillow matplotlib
```

### 3. è¿è¡Œç¤ºä¾‹ä»£ç 

#### è¿è¡Œæ•°æ®åŠ è½½ç¤ºä¾‹
```bash
python read_data.py
```

#### è¿è¡Œå®Œæ•´è®­ç»ƒæµç¨‹
```bash
python train.py
```

#### ä½¿ç”¨TensorBoardæŸ¥çœ‹è®­ç»ƒè¿‡ç¨‹
```bash
tensorboard --logdir=./logs_train
```
ç„¶ååœ¨æµè§ˆå™¨ä¸­è®¿é—® `http://localhost:6006`

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
PytorchByTuDui/
â”œâ”€â”€ ğŸ“„ README.md                      # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ ğŸ“‚ ç¬”è®°/                          # Jupyterç¬”è®°ç›®å½•
â”‚   â”œâ”€â”€ 103_PytorchåŠ è½½æ•°æ®.ipynb
â”‚   â”œâ”€â”€ 104_Tensorboardä½¿ç”¨.ipynb
â”‚   â”œâ”€â”€ 105_Transformsä½¿ç”¨.ipynb
â”‚   â”œâ”€â”€ 106_torchvisionæ•°æ®é›†ä½¿ç”¨.ipynb
â”‚   â”œâ”€â”€ 107_Dataloaderä½¿ç”¨.ipynb
â”‚   â”œâ”€â”€ 108_nn.Moduleæ¨¡å—ä½¿ç”¨.ipynb
â”‚   â”œâ”€â”€ 109_å·ç§¯åŸç†.ipynb
â”‚   â”œâ”€â”€ 110_å·ç§¯å±‚.ipynb
â”‚   â”œâ”€â”€ 111_æœ€å¤§æ± åŒ–å±‚.ipynb
â”‚   â”œâ”€â”€ 112_éçº¿æ€§æ¿€æ´».ipynb
â”‚   â”œâ”€â”€ 113_çº¿æ€§å±‚åŠå…¶ä»–å±‚.ipynb
â”‚   â”œâ”€â”€ 114_æ­å»ºå°å®æˆ˜å’ŒSequentialä½¿ç”¨.ipynb
â”‚   â”œâ”€â”€ 115_æŸå¤±å‡½æ•°ä¸åå‘ä¼ æ’­.ipynb
â”‚   â”œâ”€â”€ 116_ä¼˜åŒ–å™¨.ipynb
â”‚   â”œâ”€â”€ 117_ç½‘ç»œæ¨¡å‹ä½¿ç”¨åŠä¿®æ”¹.ipynb
â”‚   â”œâ”€â”€ 118_ç½‘ç»œæ¨¡å‹ä¿å­˜ä¸è¯»å–.ipynb
â”‚   â”œâ”€â”€ 119_å®Œæ•´æ¨¡å‹è®­ç»ƒå¥—è·¯.ipynb
â”‚   â”œâ”€â”€ 120_åˆ©ç”¨GPUè®­ç»ƒ.ipynb
â”‚   â””â”€â”€ 121_å®Œæ•´æ¨¡å‹éªŒè¯å¥—è·¯.ipynb
â”‚
â”œâ”€â”€ ğŸ æ•°æ®å¤„ç†ç›¸å…³
â”‚   â”œâ”€â”€ read_data.py                  # æ•°æ®é›†è¯»å–åŸºç¡€ç¤ºä¾‹
â”‚   â”œâ”€â”€ dataset_transform.py          # æ•°æ®é›†å˜æ¢ç¤ºä¾‹
â”‚   â”œâ”€â”€ dataloader.py                 # DataLoaderä½¿ç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ use_transform.py              # Transformsåº”ç”¨ç¤ºä¾‹
â”‚   â””â”€â”€ First-transforms.py           # Transformså…¥é—¨
â”‚
â”œâ”€â”€ ğŸ§  ç¥ç»ç½‘ç»œæ¨¡å—
â”‚   â”œâ”€â”€ nn_module.py                  # nn.ModuleåŸºç¡€
â”‚   â”œâ”€â”€ nn_conv.py                    # å·ç§¯å±‚ç¤ºä¾‹
â”‚   â”œâ”€â”€ nn_conv2d.py                  # 2Då·ç§¯è¯¦è§£
â”‚   â”œâ”€â”€ nn_maxpool.py                 # æœ€å¤§æ± åŒ–å±‚
â”‚   â”œâ”€â”€ nn_relu.py                    # ReLUæ¿€æ´»å‡½æ•°
â”‚   â”œâ”€â”€ nn_linear.py                  # çº¿æ€§å±‚ï¼ˆå…¨è¿æ¥å±‚ï¼‰
â”‚   â”œâ”€â”€ nn_sequential.py              # Sequentialå®¹å™¨ä½¿ç”¨
â”‚   â”œâ”€â”€ nn_loss.py                    # æŸå¤±å‡½æ•°ç¤ºä¾‹
â”‚   â”œâ”€â”€ nn_loss_network.py            # æŸå¤±å‡½æ•°ä¸ç½‘ç»œç»“åˆ
â”‚   â””â”€â”€ nn_optim.py                   # ä¼˜åŒ–å™¨ä½¿ç”¨
â”‚
â”œâ”€â”€ ğŸ¯ æ¨¡å‹ç›¸å…³
â”‚   â”œâ”€â”€ model.py                      # ç¥ç»ç½‘ç»œæ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ model_pretrained.py           # é¢„è®­ç»ƒæ¨¡å‹ä½¿ç”¨
â”‚   â”œâ”€â”€ model_save.py                 # æ¨¡å‹ä¿å­˜ä¸åŠ è½½
â”‚   â”œâ”€â”€ train.py                      # å®Œæ•´è®­ç»ƒæµç¨‹
â”‚   â”œâ”€â”€ train_gpu_1.py                # GPUè®­ç»ƒæ–¹å¼1
â”‚   â”œâ”€â”€ train_gpu_2.py                # GPUè®­ç»ƒæ–¹å¼2
â”‚   â””â”€â”€ test.py                       # æ¨¡å‹æµ‹è¯•ä¸æ¨ç†
â”‚
â””â”€â”€ ğŸ“Š å¯è§†åŒ–å·¥å…·
    â””â”€â”€ use_Tensorboard.py            # TensorBoardä½¿ç”¨ç¤ºä¾‹
```

---

## ğŸ“š æ¨¡å—è¯¦è§£

### æ•°æ®å¤„ç†æ¨¡å—

#### `read_data.py` - æ•°æ®è¯»å–åŸºç¡€
å­¦ä¹ å¦‚ä½•ä½¿ç”¨PyTorchçš„Datasetç±»æ¥è‡ªå®šä¹‰æ•°æ®é›†ï¼Œç†è§£æ•°æ®è¯»å–çš„åŸºæœ¬æµç¨‹ã€‚

**æ ¸å¿ƒå†…å®¹ï¼š**
- Datasetç±»çš„åŸºæœ¬ç»“æ„
- `__init__`, `__len__`, `__getitem__`æ–¹æ³•çš„å®ç°
- å›¾åƒä¸æ ‡ç­¾çš„å¯¹åº”å…³ç³»å¤„ç†

#### `dataloader.py` - DataLoaderä½¿ç”¨
æŒæ¡DataLoaderçš„ä½¿ç”¨æ–¹æ³•ï¼Œå­¦ä¹ å¦‚ä½•æ‰¹é‡åŠ è½½æ•°æ®ã€‚

**æ ¸å¿ƒå†…å®¹ï¼š**
- batch_sizeå‚æ•°è®¾ç½®
- shuffleæ•°æ®æ‰“ä¹±
- num_workerså¤šè¿›ç¨‹åŠ è½½
- drop_lastå‚æ•°ä½¿ç”¨

#### `use_transform.py` & `dataset_transform.py` - æ•°æ®å˜æ¢
å­¦ä¹ ä½¿ç”¨torchvision.transformså¯¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ã€‚

**æ ¸å¿ƒå†…å®¹ï¼š**
- ToTensorè½¬æ¢
- Resizeè°ƒæ•´å¤§å°
- Normalizeå½’ä¸€åŒ–
- Composeç»„åˆå¤šä¸ªå˜æ¢
- RandomCropã€RandomHorizontalFlipç­‰æ•°æ®å¢å¼º

---

### ç¥ç»ç½‘ç»œå±‚æ¨¡å—

#### `nn_module.py` - ç¥ç»ç½‘ç»œåŸºç¡€
ç†è§£nn.Moduleçš„åŸºæœ¬æ¦‚å¿µå’Œä½¿ç”¨æ–¹æ³•ã€‚

#### `nn_conv.py` & `nn_conv2d.py` - å·ç§¯å±‚
æ·±å…¥ç†è§£2Då·ç§¯æ“ä½œçš„åŸç†å’Œåº”ç”¨ã€‚

**æ ¸å¿ƒæ¦‚å¿µï¼š**
- in_channels: è¾“å…¥é€šé“æ•°
- out_channels: è¾“å‡ºé€šé“æ•°ï¼ˆå·ç§¯æ ¸æ•°é‡ï¼‰
- kernel_size: å·ç§¯æ ¸å¤§å°
- stride: æ­¥é•¿
- padding: å¡«å……

#### `nn_maxpool.py` - æœ€å¤§æ± åŒ–å±‚
å­¦ä¹ æ± åŒ–å±‚çš„ä½œç”¨ï¼šä¸‹é‡‡æ ·ã€å‡å°‘å‚æ•°ã€é˜²æ­¢è¿‡æ‹Ÿåˆã€‚

**æ ¸å¿ƒæ¦‚å¿µï¼š**
- kernel_size: æ± åŒ–çª—å£å¤§å°
- stride: æ­¥é•¿
- padding: å¡«å……
- ceil_mode: å‘ä¸Šå–æ•´æ¨¡å¼

#### `nn_relu.py` - æ¿€æ´»å‡½æ•°
ç†è§£éçº¿æ€§æ¿€æ´»å‡½æ•°ReLUçš„ä½œç”¨å’Œåº”ç”¨ã€‚

**å¸¸ç”¨æ¿€æ´»å‡½æ•°ï¼š**
- ReLU: æœ€å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°
- Sigmoid: ç”¨äºäºŒåˆ†ç±»è¾“å‡ºå±‚
- Softmax: ç”¨äºå¤šåˆ†ç±»è¾“å‡ºå±‚

#### `nn_linear.py` - çº¿æ€§å±‚ï¼ˆå…¨è¿æ¥å±‚ï¼‰
å­¦ä¹ å…¨è¿æ¥å±‚çš„ä½¿ç”¨ï¼Œé€šå¸¸ç”¨äºç½‘ç»œçš„æœ€åå‡ å±‚ã€‚

**æ ¸å¿ƒæ¦‚å¿µï¼š**
- in_features: è¾“å…¥ç‰¹å¾æ•°
- out_features: è¾“å‡ºç‰¹å¾æ•°
- bias: åç½®é¡¹

#### `nn_sequential.py` - Sequentialå®¹å™¨
å­¦ä¹ ä½¿ç”¨Sequentialå¿«é€Ÿæ­å»ºç¥ç»ç½‘ç»œã€‚

**ä¼˜åŠ¿ï¼š**
- ç®€æ´æ˜äº†çš„ç½‘ç»œå®šä¹‰æ–¹å¼
- è‡ªåŠ¨å®Œæˆå‰å‘ä¼ æ’­çš„è¿æ¥
- é€‚åˆé¡ºåºæ‰§è¡Œçš„ç½‘ç»œç»“æ„

#### `nn_loss.py` & `nn_loss_network.py` - æŸå¤±å‡½æ•°
ç†è§£æŸå¤±å‡½æ•°çš„ä½œç”¨åŠå¸¸ç”¨æŸå¤±å‡½æ•°çš„åº”ç”¨åœºæ™¯ã€‚

**å¸¸ç”¨æŸå¤±å‡½æ•°ï¼š**
- CrossEntropyLoss: å¤šåˆ†ç±»ä»»åŠ¡
- MSELoss: å›å½’ä»»åŠ¡
- BCELoss: äºŒåˆ†ç±»ä»»åŠ¡

#### `nn_optim.py` - ä¼˜åŒ–å™¨
å­¦ä¹ å¦‚ä½•ä½¿ç”¨ä¼˜åŒ–å™¨æ›´æ–°ç½‘ç»œå‚æ•°ã€‚

**å¸¸ç”¨ä¼˜åŒ–å™¨ï¼š**
- SGD: éšæœºæ¢¯åº¦ä¸‹é™
- Adam: è‡ªé€‚åº”å­¦ä¹ ç‡ä¼˜åŒ–å™¨
- RMSprop: å‡æ–¹æ ¹ä¼ æ’­

---

### æ¨¡å‹è®­ç»ƒæ¨¡å—

#### `model.py` - ç¥ç»ç½‘ç»œæ¨¡å‹
å®Œæ•´çš„CNNç½‘ç»œç»“æ„å®šä¹‰ï¼ˆTuduiæ¨¡å‹ï¼‰ã€‚

**ç½‘ç»œç»“æ„ï¼š**
```python
Sequential(
    Conv2d(3, 32, 5, 1, 2),      # ç¬¬1ä¸ªå·ç§¯å±‚
    MaxPool2d(2),                 # ç¬¬1ä¸ªæ± åŒ–å±‚
    Conv2d(32, 32, 5, 1, 2),     # ç¬¬2ä¸ªå·ç§¯å±‚
    MaxPool2d(2),                 # ç¬¬2ä¸ªæ± åŒ–å±‚
    Conv2d(32, 64, 5, 1, 2),     # ç¬¬3ä¸ªå·ç§¯å±‚
    MaxPool2d(2),                 # ç¬¬3ä¸ªæ± åŒ–å±‚
    Flatten(),                    # å±•å¹³å±‚
    Linear(64*4*4, 64),          # ç¬¬1ä¸ªå…¨è¿æ¥å±‚
    Linear(64, 10)                # è¾“å‡ºå±‚ï¼ˆ10åˆ†ç±»ï¼‰
)
```

#### `train.py` - å®Œæ•´è®­ç»ƒæµç¨‹
å­¦ä¹ ç¥ç»ç½‘ç»œè®­ç»ƒçš„æ ‡å‡†æµç¨‹ã€‚

**è®­ç»ƒæ­¥éª¤ï¼š**
1. å‡†å¤‡æ•°æ®é›†ï¼ˆCIFAR10ï¼‰
2. åˆ›å»ºDataLoader
3. å®šä¹‰ç½‘ç»œæ¨¡å‹
4. å®šä¹‰æŸå¤±å‡½æ•°
5. å®šä¹‰ä¼˜åŒ–å™¨
6. è®­ç»ƒå¾ªç¯
   - å‰å‘ä¼ æ’­
   - è®¡ç®—æŸå¤±
   - åå‘ä¼ æ’­
   - æ›´æ–°å‚æ•°
7. éªŒè¯/æµ‹è¯•
8. ä¿å­˜æ¨¡å‹

#### `train_gpu_1.py` & `train_gpu_2.py` - GPUè®­ç»ƒ
å­¦ä¹ å¦‚ä½•ä½¿ç”¨GPUåŠ é€Ÿè®­ç»ƒè¿‡ç¨‹ã€‚

**ä¸¤ç§æ–¹å¼ï¼š**
- æ–¹å¼1ï¼šä½¿ç”¨`.cuda()`æ–¹æ³•
- æ–¹å¼2ï¼šä½¿ç”¨`.to(device)`æ–¹æ³•

**æ³¨æ„äº‹é¡¹ï¼š**
- æ¨¡å‹éœ€è¦ç§»åˆ°GPU
- æ•°æ®éœ€è¦ç§»åˆ°GPU
- æŸå¤±å‡½æ•°å¯èƒ½éœ€è¦ç§»åˆ°GPU

#### `model_save.py` - æ¨¡å‹ä¿å­˜ä¸åŠ è½½
å­¦ä¹ ä¸¤ç§æ¨¡å‹ä¿å­˜æ–¹å¼ã€‚

**æ–¹å¼1ï¼šä¿å­˜æ•´ä¸ªæ¨¡å‹**
```python
torch.save(model, 'model.pth')
model = torch.load('model.pth')
```

**æ–¹å¼2ï¼šä»…ä¿å­˜å‚æ•°ï¼ˆæ¨èï¼‰**
```python
torch.save(model.state_dict(), 'model_params.pth')
model.load_state_dict(torch.load('model_params.pth'))
```

#### `model_pretrained.py` - é¢„è®­ç»ƒæ¨¡å‹
å­¦ä¹ å¦‚ä½•ä½¿ç”¨å’Œä¿®æ”¹é¢„è®­ç»ƒæ¨¡å‹ï¼ˆå¦‚VGGã€ResNetç­‰ï¼‰ã€‚

---

### æ¨¡å‹æµ‹è¯•ä¸åº”ç”¨

#### `test.py` - æ¨¡å‹æµ‹è¯•ä¸æ¨ç†
å­¦ä¹ å¦‚ä½•åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚

**æµ‹è¯•æµç¨‹ï¼š**
1. åŠ è½½æ¨¡å‹
2. é¢„å¤„ç†è¾“å…¥å›¾åƒ
3. è®¾ç½®æ¨¡å‹ä¸ºè¯„ä¼°æ¨¡å¼ï¼ˆ`model.eval()`ï¼‰
4. å…³é—­æ¢¯åº¦è®¡ç®—ï¼ˆ`with torch.no_grad()`ï¼‰
5. è¿›è¡Œé¢„æµ‹
6. è§£æè¾“å‡ºç»“æœ

---

### å¯è§†åŒ–å·¥å…·

#### `use_Tensorboard.py` - TensorBoardä½¿ç”¨
å­¦ä¹ ä½¿ç”¨TensorBoardå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ã€‚

**ä¸»è¦åŠŸèƒ½ï¼š**
- å¯è§†åŒ–æ ‡é‡ï¼ˆæŸå¤±ã€å‡†ç¡®ç‡ç­‰ï¼‰
- å¯è§†åŒ–å›¾åƒ
- å¯è§†åŒ–ç½‘ç»œç»“æ„
- å¯è§†åŒ–åµŒå…¥å‘é‡

**ä½¿ç”¨æ–¹æ³•ï¼š**
```python
from torch.utils.tensorboard import SummaryWriter

writer = SummaryWriter('logs')
writer.add_scalar('loss', loss_value, step)
writer.add_images('images', img_tensor, step)
writer.close()
```

---

## ğŸ““ Jupyterç¬”è®°

é¡¹ç›®åŒ…å«20ä¸ªJupyterç¬”è®°æœ¬ï¼Œæ¶µç›–PyTorchå­¦ä¹ çš„å„ä¸ªæ–¹é¢ï¼š

| ç¬”è®°ç¼–å· | ä¸»é¢˜ | å†…å®¹æ¦‚è¦ |
|---------|------|---------|
| 103 | PytorchåŠ è½½æ•°æ® | Datasetå’ŒDataLoaderçš„ä½¿ç”¨ |
| 104 | Tensorboardä½¿ç”¨ | å¯è§†åŒ–å·¥å…·çš„åŸºæœ¬æ“ä½œ |
| 105 | Transformsä½¿ç”¨ | æ•°æ®é¢„å¤„ç†å’Œå¢å¼º |
| 106 | torchvisionæ•°æ®é›†ä½¿ç”¨ | ä½¿ç”¨å†…ç½®æ•°æ®é›† |
| 107 | Dataloaderä½¿ç”¨ | æ‰¹é‡åŠ è½½æ•°æ®çš„é«˜çº§æŠ€å·§ |
| 108 | nn.Moduleæ¨¡å—ä½¿ç”¨ | ç¥ç»ç½‘ç»œæ¨¡å—çš„åŸºç¡€ |
| 109 | å·ç§¯åŸç† | å·ç§¯æ“ä½œçš„æ•°å­¦åŸç† |
| 110 | å·ç§¯å±‚ | Conv2då±‚çš„è¯¦ç»†ä½¿ç”¨ |
| 111 | æœ€å¤§æ± åŒ–å±‚ | MaxPool2då±‚çš„ä½¿ç”¨ |
| 112 | éçº¿æ€§æ¿€æ´» | æ¿€æ´»å‡½æ•°çš„ä½œç”¨å’Œé€‰æ‹© |
| 113 | çº¿æ€§å±‚åŠå…¶ä»–å±‚ | å…¨è¿æ¥å±‚ç­‰å…¶ä»–å±‚ |
| 114 | æ­å»ºå°å®æˆ˜å’ŒSequentialä½¿ç”¨ | ä½¿ç”¨Sequentialå¿«é€Ÿæ­å»ºç½‘ç»œ |
| 115 | æŸå¤±å‡½æ•°ä¸åå‘ä¼ æ’­ | æŸå¤±è®¡ç®—å’Œæ¢¯åº¦åä¼  |
| 116 | ä¼˜åŒ–å™¨ | å„ç§ä¼˜åŒ–å™¨çš„ä½¿ç”¨ |
| 117 | ç½‘ç»œæ¨¡å‹ä½¿ç”¨åŠä¿®æ”¹ | é¢„è®­ç»ƒæ¨¡å‹çš„ä½¿ç”¨ |
| 118 | ç½‘ç»œæ¨¡å‹ä¿å­˜ä¸è¯»å– | æ¨¡å‹æŒä¹…åŒ– |
| 119 | å®Œæ•´æ¨¡å‹è®­ç»ƒå¥—è·¯ | ç«¯åˆ°ç«¯è®­ç»ƒæµç¨‹ |
| 120 | åˆ©ç”¨GPUè®­ç»ƒ | GPUåŠ é€Ÿè®­ç»ƒ |
| 121 | å®Œæ•´æ¨¡å‹éªŒè¯å¥—è·¯ | æ¨¡å‹æµ‹è¯•å’ŒéªŒè¯ |
| 122 | æŸ¥çœ‹å¼€æºé¡¹ç›® | å¦‚ä½•å­¦ä¹ å¼€æºä»£ç  |

---

## ğŸ¯ å­¦ä¹ è·¯å¾„

### ç¬¬ä¸€é˜¶æ®µï¼šPyTorchåŸºç¡€ï¼ˆç¬¬1-3å¤©ï¼‰
1. **æ•°æ®å¤„ç†**
   - å­¦ä¹  `read_data.py`ã€`dataset_transform.py`
   - ç¬”è®°ï¼š103ã€105ã€106ã€107
   
2. **å¯è§†åŒ–å·¥å…·**
   - å­¦ä¹  `use_Tensorboard.py`
   - ç¬”è®°ï¼š104

### ç¬¬äºŒé˜¶æ®µï¼šç¥ç»ç½‘ç»œåŸºç¡€ï¼ˆç¬¬4-7å¤©ï¼‰
3. **ç¥ç»ç½‘ç»œæ¨¡å—**
   - å­¦ä¹  `nn_module.py`ã€`nn_conv2d.py`ã€`nn_maxpool.py`
   - ç¬”è®°ï¼š108ã€109ã€110ã€111
   
4. **æ¿€æ´»å‡½æ•°å’Œå…¨è¿æ¥å±‚**
   - å­¦ä¹  `nn_relu.py`ã€`nn_linear.py`ã€`nn_sequential.py`
   - ç¬”è®°ï¼š112ã€113ã€114

### ç¬¬ä¸‰é˜¶æ®µï¼šæ¨¡å‹è®­ç»ƒï¼ˆç¬¬8-12å¤©ï¼‰
5. **æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨**
   - å­¦ä¹  `nn_loss.py`ã€`nn_optim.py`
   - ç¬”è®°ï¼š115ã€116
   
6. **å®Œæ•´è®­ç»ƒæµç¨‹**
   - å­¦ä¹  `model.py`ã€`train.py`
   - ç¬”è®°ï¼š119

### ç¬¬å››é˜¶æ®µï¼šè¿›é˜¶åº”ç”¨ï¼ˆç¬¬13-15å¤©ï¼‰
7. **GPUè®­ç»ƒ**
   - å­¦ä¹  `train_gpu_1.py`ã€`train_gpu_2.py`
   - ç¬”è®°ï¼š120
   
8. **æ¨¡å‹ä¿å­˜å’Œæµ‹è¯•**
   - å­¦ä¹  `model_save.py`ã€`test.py`
   - ç¬”è®°ï¼š118ã€121

9. **é¢„è®­ç»ƒæ¨¡å‹**
   - å­¦ä¹  `model_pretrained.py`
   - ç¬”è®°ï¼š117

---

## ğŸ“¦ æ•°æ®é›†è¯´æ˜

### CIFAR-10 æ•°æ®é›†

æœ¬é¡¹ç›®ä¸»è¦ä½¿ç”¨CIFAR-10æ•°æ®é›†è¿›è¡Œè®­ç»ƒå’Œæµ‹è¯•ã€‚

**æ•°æ®é›†ç‰¹ç‚¹ï¼š**
- 60,000å¼ 32x32å½©è‰²å›¾åƒ
- 10ä¸ªç±»åˆ«ï¼Œæ¯ç±»6,000å¼ å›¾åƒ
- 50,000å¼ è®­ç»ƒå›¾åƒ
- 10,000å¼ æµ‹è¯•å›¾åƒ

**ç±»åˆ«æ ‡ç­¾ï¼š**
- 0: airplaneï¼ˆé£æœºï¼‰
- 1: automobileï¼ˆæ±½è½¦ï¼‰
- 2: birdï¼ˆé¸Ÿï¼‰
- 3: catï¼ˆçŒ«ï¼‰
- 4: deerï¼ˆé¹¿ï¼‰
- 5: dogï¼ˆç‹—ï¼‰
- 6: frogï¼ˆé’è›™ï¼‰
- 7: horseï¼ˆé©¬ï¼‰
- 8: shipï¼ˆèˆ¹ï¼‰
- 9: truckï¼ˆå¡è½¦ï¼‰

**è‡ªåŠ¨ä¸‹è½½ï¼š**
ä»£ç ä¼šè‡ªåŠ¨ä¸‹è½½CIFAR-10æ•°æ®é›†åˆ°`./dataset`ç›®å½•ã€‚

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šè®­ç»ƒä¸€ä¸ªç®€å•çš„åˆ†ç±»æ¨¡å‹

```python
import torch
import torchvision
from torch import nn
from torch.utils.data import DataLoader

# 1. åŠ è½½æ•°æ®
train_data = torchvision.datasets.CIFAR10(
    root="./dataset", 
    train=True, 
    transform=torchvision.transforms.ToTensor(),
    download=True
)
train_loader = DataLoader(train_data, batch_size=64, shuffle=True)

# 2. å®šä¹‰æ¨¡å‹
class SimpleNet(nn.Module):
    def __init__(self):
        super(SimpleNet, self).__init__()
        self.model = nn.Sequential(
            nn.Conv2d(3, 32, 5, 1, 2),
            nn.MaxPool2d(2),
            nn.Conv2d(32, 64, 5, 1, 2),
            nn.MaxPool2d(2),
            nn.Flatten(),
            nn.Linear(64*8*8, 10)
        )
    
    def forward(self, x):
        return self.model(x)

# 3. è®­ç»ƒé…ç½®
model = SimpleNet()
loss_fn = nn.CrossEntropyLoss()
optimizer = torch.optim.SGD(model.parameters(), lr=0.01)

# 4. è®­ç»ƒå¾ªç¯
for epoch in range(10):
    for imgs, targets in train_loader:
        outputs = model(imgs)
        loss = loss_fn(outputs, targets)
        
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()
    
    print(f"Epoch {epoch+1}, Loss: {loss.item()}")

# 5. ä¿å­˜æ¨¡å‹
torch.save(model.state_dict(), 'model.pth')
```

### ç¤ºä¾‹2ï¼šä½¿ç”¨TensorBoardå¯è§†åŒ–

```python
from torch.utils.tensorboard import SummaryWriter

writer = SummaryWriter('./logs')

for epoch in range(10):
    # è®­ç»ƒä»£ç ...
    writer.add_scalar('Loss/train', loss.item(), epoch)
    writer.add_scalar('Accuracy/train', accuracy, epoch)

writer.close()

# åœ¨ç»ˆç«¯è¿è¡Œï¼štensorboard --logdir=./logs
```

### ç¤ºä¾‹3ï¼šä½¿ç”¨GPUè®­ç»ƒ

```python
# æ£€æŸ¥GPUæ˜¯å¦å¯ç”¨
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
print(f"Using device: {device}")

# å°†æ¨¡å‹å’Œæ•°æ®ç§»åˆ°GPU
model = model.to(device)

for imgs, targets in train_loader:
    imgs, targets = imgs.to(device), targets.to(device)
    
    outputs = model(imgs)
    loss = loss_fn(outputs, targets)
    
    optimizer.zero_grad()
    loss.backward()
    optimizer.step()
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•è§£å†³CUDA out of memoryé”™è¯¯ï¼Ÿ
**A:** 
- å‡å°batch_size
- å‡å°æ¨¡å‹å°ºå¯¸
- ä½¿ç”¨æ¢¯åº¦ç´¯ç§¯
- ä½¿ç”¨æ··åˆç²¾åº¦è®­ç»ƒ

### Q2: è®­ç»ƒè¿‡ç¨‹ä¸­æŸå¤±ä¸ä¸‹é™æ€ä¹ˆåŠï¼Ÿ
**A:**
- æ£€æŸ¥å­¦ä¹ ç‡æ˜¯å¦åˆé€‚
- æ£€æŸ¥æ•°æ®é¢„å¤„ç†æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç½‘ç»œç»“æ„æ˜¯å¦åˆç†
- å°è¯•ä¸åŒçš„ä¼˜åŒ–å™¨

### Q3: å¦‚ä½•é€‰æ‹©åˆé€‚çš„å­¦ä¹ ç‡ï¼Ÿ
**A:**
- ä»0.001å¼€å§‹å°è¯•
- ä½¿ç”¨å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼ˆå¦‚StepLRã€ReduceLROnPlateauï¼‰
- ä½¿ç”¨å­¦ä¹ ç‡æŸ¥æ‰¾å·¥å…·

### Q4: ä¸ºä»€ä¹ˆæµ‹è¯•é›†å‡†ç¡®ç‡æ¯”è®­ç»ƒé›†ä½å¾ˆå¤šï¼Ÿ
**A:**
- å¯èƒ½è¿‡æ‹Ÿåˆï¼Œå°è¯•å¢åŠ Dropout
- å¯èƒ½éœ€è¦æ•°æ®å¢å¼º
- å¯èƒ½éœ€è¦æ­£åˆ™åŒ–

### Q5: å¦‚ä½•åœ¨CPUå’ŒGPUä¹‹é—´åˆ‡æ¢è®­ç»ƒï¼Ÿ
**A:**
```python
# è‡ªåŠ¨é€‰æ‹©è®¾å¤‡
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")

# æˆ–è€…æ‰‹åŠ¨æŒ‡å®š
device = torch.device("cpu")  # ä½¿ç”¨CPU
device = torch.device("cuda:0")  # ä½¿ç”¨ç¬¬ä¸€ä¸ªGPU
```

---


## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªStaræ”¯æŒä¸€ä¸‹ï¼â­**
</div>
